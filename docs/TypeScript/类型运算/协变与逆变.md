# 协变与逆变

协变和逆变是函数类型中的概念，用于解决两个函数类型什么时候可以赋值什么时候不能赋值

> **“返回值协变，参数逆变”**

## 协变

- **子类型可以“向上”替换**
- 适用于：函数的返回值**
- 直觉：**“我可以返回更具体的东西”**

```ts
type Animal = { name: string };
type Dog = Animal & { bark: () => void };

type GetDog = () => Dog;
type GetAnimal = () => Animal;

let getDog: GetDog = () => ({ name: "Rex", bark: () => {} });
let getAnimal: GetAnimal = getDog; // ✅ 合法，协变
```





## 逆变

- **父类型可以“向下”替换**

- 适用于：**函数参数**
- 直觉：**“我可以接受更宽泛的东西”**

```ts
type Handler<T> = (arg: T) => void;

let handleAnimal: Handler<Animal> = (a: Animal) => console.log(a.name);
let handleDog: Handler<Dog> = handleAnimal; // ✅ 合法，逆变

// 反过来不行：
// handleAnimal = handleDog; // ❌ 错误
```



## **子类型赋值**

TypeScript 允许**子类型的值赋值给父类型的变量**（这是**结构类型系统**的核心）

```ts
type Animal = { name: string };
type Dog = Animal & { bark: () => void };

const dog: Dog = {
  name: "Rex",
  bark: () => console.log("woof")
};

const animal: Animal = dog; // ✅ 完全合法
```

`Dog` 是 `Animal` 的**子类型**（因为 `Dog` 包含 `Animal` 的所有属性）